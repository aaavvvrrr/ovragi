***

# Satellite Segmentation Pipeline (YOLOv8 + Rasterio)

–≠—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–∞–π–ø–ª–∞–π–Ω –¥–ª—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ —Å–ø—É—Ç–Ω–∏–∫–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö (GeoTIFF + Shapefile) –∏ –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤ (Instance Segmentation) —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞ **Ultralytics (YOLOv8/v11)**.

–ü—Ä–æ–µ–∫—Ç —Ä–µ—à–∞–µ—Ç —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ –î–ó–ó (–¥–∞–Ω–Ω—ã—Ö –¥–∏—Å—Ç–∞–Ω—Ü–∏–æ–Ω–Ω–æ–≥–æ –∑–æ–Ω–¥–∏—Ä–æ–≤–∞–Ω–∏—è –ó–µ–º–ª–∏), —Ç–∞–∫–∏–µ –∫–∞–∫ –æ–≥—Ä–æ–º–Ω—ã–π —Ä–∞–∑–º–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –≥–µ–æ–ø—Ä–∏–≤—è–∑–∫–∞ –∏ –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ —Å–Ω–∏–º–∫–æ–≤.

> **–ê–≤—Ç–æ—Ä—Å—Ç–≤–æ:** –ö–æ–¥ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã –ò–ò –∞–≥–µ–Ω—Ç–æ–º **Gemini 3.0 Pro Preview**.

---

## üß† –ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è –∏ –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

–ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å–æ —Å–ø—É—Ç–Ω–∏–∫–æ–≤—ã–º–∏ —Å–Ω–∏–º–∫–∞–º–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –º–µ—Ç–æ–¥—ã –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–≥–æ –∑—Ä–µ–Ω–∏—è (CV) —á–∞—Å—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç. –í —ç—Ç–æ–º —Ä–µ—à–µ–Ω–∏–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –∫–ª—é—á–µ–≤—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏:

### 1. –ü—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ —Ä–∞–∑–±–∏–µ–Ω–∏–µ (Spatial Split) –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è —É—Ç–µ—á–∫–∏ –¥–∞–Ω–Ω—ã—Ö
**–ü—Ä–æ–±–ª–µ–º–∞:** –°–ø—É—Ç–Ω–∏–∫–æ–≤—ã–µ —Å–Ω–∏–º–∫–∏ —á–∞—Å—Ç–æ –ø–µ—Ä–µ–∫—Ä—ã–≤–∞—é—Ç—Å—è (overlap). –ï—Å–ª–∏ –ø—Ä–æ—Å—Ç–æ —Ä–∞–∑–±–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ –∏–ª–∏ —Ç–∞–π–ª–æ–≤ —Å–ª—É—á–∞–π–Ω–æ –Ω–∞ Train/Val, —Ç–∞–π–ª—ã –æ–¥–Ω–æ–π –∏ —Ç–æ–π –∂–µ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –¥–æ–º, —Å–Ω—è—Ç—ã–π –¥–≤–∞–∂–¥—ã) –ø–æ–ø–∞–¥—É—Ç –∏ –≤ –æ–±—É—á–µ–Ω–∏–µ, –∏ –≤ –≤–∞–ª–∏–¥–∞—Ü–∏—é. –≠—Ç–æ –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ Data Leakage –∏ –ª–æ–∂–Ω–æ –≤—ã—Å–æ–∫–∏–º –º–µ—Ç—Ä–∏–∫–∞–º.
**–†–µ—à–µ–Ω–∏–µ:**
*   –í—ã—á–∏—Å–ª—è—é—Ç—Å—è –æ–±—â–∏–µ –≥—Ä–∞–Ω–∏—Ü—ã (bounding box) –≤—Å–µ–π –æ–±–ª–∞—Å—Ç–∏ –∏–Ω—Ç–µ—Ä–µ—Å–∞.
*   –¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è —Ä–∞–∑–±–∏–≤–∞–µ—Ç—Å—è –Ω–∞ –∫—Ä—É–ø–Ω—É—é —Å–µ—Ç–∫—É (Grid, –Ω–∞–ø—Ä–∏–º–µ—Ä, 10x10 —è—á–µ–µ–∫).
*   –ö–∞–∂–¥–æ–π —è—á–µ–π–∫–µ –∂–µ—Å—Ç–∫–æ –Ω–∞–∑–Ω–∞—á–∞–µ—Ç—Å—è —Å—Ç–∞—Ç—É—Å `train` –∏–ª–∏ `val`.
*   –¢–∞–π–ª –ø–æ–ø–∞–¥–∞–µ—Ç –≤ –≤—ã–±–æ—Ä–∫—É –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–æ–≥–æ, –≤ –∫–∞–∫–æ–π –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –∫–≤–∞–¥—Ä–∞—Ç –ø–æ–ø–∞–¥–∞–µ—Ç –µ–≥–æ —Ü–µ–Ω—Ç—Ä.
*   **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –∏–∑–æ–ª—è—Ü–∏—è –≤—ã–±–æ—Ä–æ–∫.

### 2. –¢–∞–π–ª–∏–Ω–≥ —Å –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ–º (Sliding Window)
**–ü—Ä–æ–±–ª–µ–º–∞:** –û–±—ä–µ–∫—Ç—ã –Ω–∞ –≥—Ä–∞–Ω–∏—Ü–µ —Ä–∞–∑—Ä–µ–∑–∞ —Ç–∞–π–ª–æ–≤ (640x640) —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–º–∏ –∏–ª–∏ –æ–±—Ä–µ–∑–∞—é—Ç—Å—è, —á—Ç–æ —É—Ö—É–¥—à–∞–µ—Ç –æ–±—É—á–µ–Ω–∏–µ.
**–†–µ—à–µ–Ω–∏–µ:** –°–Ω–∏–º–∫–∏ –Ω–∞—Ä–µ–∑–∞—é—Ç—Å—è —Å –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ–º (overlap, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 20%). –≠—Ç–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—É—á–∞—é—â–∏—Ö –ø—Ä–∏–º–µ—Ä–æ–≤ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –æ–±—ä–µ–∫—Ç–æ–≤.

### 3. –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –∫–ª–∞—Å—Å–æ–≤ (Filtering)
**–ü—Ä–æ–±–ª–µ–º–∞:** –°–ø—É—Ç–Ω–∏–∫–æ–≤—ã–µ —Å–Ω–∏–º–∫–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç –æ–≥—Ä–æ–º–Ω—ã–µ –ø—É—Å—Ç—ã–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ (–ª–µ—Å–∞, –ø–æ–ª—è), –≥–¥–µ –Ω–µ—Ç —Ü–µ–ª–µ–≤—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤. –û–±—É—á–µ–Ω–∏–µ –Ω–∞ 90% –ø—É—Å—Ç—ã—Ö –∫–∞—Ä—Ç–∏–Ω–æ–∫ –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ.
**–†–µ—à–µ–Ω–∏–µ:** –°–∫—Ä–∏–ø—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ç–∞–π–ª, —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –≤ –Ω–µ–º –µ—Å—Ç—å –æ–±—ä–µ–∫—Ç—ã. –ü—É—Å—Ç—ã–µ —Ç–∞–π–ª—ã ("—Ñ–æ–Ω") –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è —Å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é 10% (–ø–∞—Ä–∞–º–µ—Ç—Ä `bg_ratio`), —á—Ç–æ–±—ã –º–æ–¥–µ–ª—å —É—á–∏–ª–∞—Å—å —Ä–∞–∑–ª–∏—á–∞—Ç—å background.

### 4. –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –≥–µ–æ-—Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è
–ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ `rasterio` –∏ `shapely` –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ –ø–µ—Ä–µ–≤–æ–¥–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –∏–∑ –ø—Ä–æ–µ–∫—Ü–∏–∏ –∫–∞—Ä—Ç—ã (CRS, –Ω–∞–ø—Ä–∏–º–µ—Ä, UTM) –≤ –ø–∏–∫—Å–µ–ª—å–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ç–∞–π–ª–∞ –∏ –ø–æ—Å–ª–µ–¥—É—é—â–µ–π –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ (0-1) –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∞ YOLO.

---

## üõ† –£—Å—Ç–∞–Ω–æ–≤–∫–∞

–î–ª—è —Ä–∞–±–æ—Ç—ã —Ç—Ä–µ–±—É—é—Ç—Å—è Python 3.8+ –∏ —Å–ª–µ–¥—É—é—â–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:

```bash
pip install ultralytics rasterio geopandas shapely opencv-python tqdm pyyaml
```

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

–ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –æ—Ä–≥–∞–Ω–∏–∑—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:


```text
project_root/
‚îú‚îÄ‚îÄ raw_data/
‚îÇ   ‚îú‚îÄ‚îÄ images/           # –ü–∞–ø–∫–∞ —Å –∏—Å—Ö–æ–¥–Ω—ã–º–∏ —Å–Ω–∏–º–∫–∞–º–∏ (*.tif)
‚îÇ   ‚îî‚îÄ‚îÄ labels.shp        # –í–µ–∫—Ç–æ—Ä–Ω—ã–π —Ñ–∞–π–ª —Å —Ä–∞–∑–º–µ—Ç–∫–æ–π
‚îú‚îÄ‚îÄ datasets/             # –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
‚îú‚îÄ‚îÄ inference_results/    # –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞–±–æ—Ç—ã –º–æ–¥–µ–ª–∏ (—Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
‚îú‚îÄ‚îÄ prepare_data_spatial.py
‚îú‚îÄ‚îÄ train_segmentation.py
‚îú‚îÄ‚îÄ predict_stitch.py     # –°–∫—Ä–∏–ø—Ç –ø—Ä–æ–≥–Ω–æ–∑–∞
‚îî‚îÄ‚îÄ README.md
```

*–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –í–µ–∫—Ç–æ—Ä–Ω—ã–π —Ñ–∞–π–ª –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–¥–∏–Ω –Ω–∞ –≤—Å–µ —Å–Ω–∏–º–∫–∏ –∏–ª–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –æ–±—ä–µ–∫—Ç—ã –¥–ª—è —á–∞—Å—Ç–∏ —Å–Ω–∏–º–∫–æ–≤. –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞–π–¥–µ—Ç –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è.*

---

## üöÄ –ó–∞–ø—É—Å–∫

### –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞

–û—Ç–∫—Ä–æ–π—Ç–µ `prepare_data_spatial.py` –∏ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Å–µ–∫—Ü–∏—é `CONFIG` (–ø—É—Ç–∏, —Ä–∞–∑–º–µ—Ä —Ç–∞–π–ª–∞, –ø—Ä–æ—Ü–µ–Ω—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏).

–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç:
```bash
python prepare_data_spatial.py
```
**–ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç:**
1. –°–∫—Ä–∏–ø—Ç –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –≥—Ä–∞–Ω–∏—Ü—ã –≤—Å–µ—Ö —Å–Ω–∏–º–∫–æ–≤ –∏ —Å–æ–∑–¥–∞—Å—Ç —Å–µ—Ç–∫—É —Ä–∞–∑–±–∏–µ–Ω–∏—è.
2. –ù–∞—Ä–µ–∂–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ —Ç–∞–π–ª—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, 640x640).
3. –ù–∞–π–¥–µ—Ç –≤–µ–∫—Ç–æ—Ä–∞ –≤–Ω—É—Ç—Ä–∏ –∫–∞–∂–¥–æ–≥–æ —Ç–∞–π–ª–∞ –∏ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –∏—Ö –≤ —Ñ–æ—Ä–º–∞—Ç YOLO TXT.
4. –û—Ç—Ñ–∏–ª—å—Ç—Ä—É–µ—Ç –ø—É—Å—Ç—ã–µ —Ç–∞–π–ª—ã.
5. –°–æ–∑–¥–∞—Å—Ç —Ñ–∞–π–ª `data.yaml`.

### –®–∞–≥ 2: –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏

–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –æ–±—É—á–µ–Ω–∏—è:
```bash
python train_segmentation.py
```
**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–±—É—á–µ–Ω–∏—è:**
*   –ú–æ–¥–µ–ª—å: `yolov8m-seg.pt` (Medium) ‚Äî –±–∞–ª–∞–Ω—Å —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏ —Ç–æ—á–Ω–æ—Å—Ç–∏.
*   –ê—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏: –í–∫–ª—é—á–µ–Ω—ã –ø–æ–≤–æ—Ä–æ—Ç—ã –Ω–∞ 90 –≥—Ä–∞–¥—É—Å–æ–≤ (FlipUD, FlipLR, Degrees), —Ç–∞–∫ –∫–∞–∫ —Å–ø—É—Ç–Ω–∏–∫–æ–≤—ã–µ —Å–Ω–∏–º–∫–∏ –Ω–µ –∏–º–µ—é—Ç "–≤–µ—Ä—Ö–∞" –∏ "–Ω–∏–∑–∞".
*   Epochs: 100.

---
### –®–∞–≥ 3: –ü—Ä–æ–≥–Ω–æ–∑ –∏ —Å—à–∏–≤–∫–∞ (Inference)

–î–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–æ–≤—ã—Ö –±–æ–ª—å—à–∏—Ö —Å–Ω–∏–º–∫–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç `predict_stitch.py`. –£–∫–∞–∂–∏—Ç–µ –ø—É—Ç—å –∫ —Å–Ω–∏–º–∫—É –∏ –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ –≤ `CONFIG`.

```bash
python predict_stitch.py
```

**–°–∫—Ä–∏–ø—Ç –≤—ã–ø–æ–ª–Ω—è–µ—Ç:**
1.  –ù–∞—Ä–µ–∑–∫—É –±–æ–ª—å—à–æ–≥–æ GeoTIFF –Ω–∞ —Ç–∞–π–ª—ã —Å –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ–º.
2.  –ü—Ä–æ–≥–Ω–æ–∑ –∏ –ø–µ—Ä–µ–≤–æ–¥ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –∏–∑ –ø–∏–∫—Å–µ–ª–µ–π –≤ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∫–∞—Ä—Ç—ã.
3.  –£–¥–∞–ª–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ (NMS).
4.  –≠–∫—Å–ø–æ—Ä—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.

**–í—ã—Ö–æ–¥–Ω—ã–µ —Ñ–∞–π–ª—ã (–≤ `inference_results/`):**
*   `predictions.shp`: –í–µ–∫—Ç–æ—Ä–Ω—ã–π —Å–ª–æ–π —Å –æ–±—ä–µ–∫—Ç–∞–º–∏ (–¥–ª—è QGIS/ArcGIS).
*   `predictions_probability.tif`: –†–∞—Å—Ç—Ä–æ–≤–∞—è —Ç–µ–ø–ª–æ–≤–∞—è –∫–∞—Ä—Ç–∞ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ (Float32).
*   `predictions.csv`: –¢–∞–±–ª–∏—Ü–∞ —Å BBox, –∫–ª–∞—Å—Å–æ–º, —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å—é –∏ WKT-–≥–µ–æ–º–µ—Ç—Ä–∏–µ–π.
*   `preview.jpg`: –û–±–ª–µ–≥—á–µ–Ω–Ω–æ–µ –ø—Ä–µ–≤—å—é —Å –æ—Ç—Ä–∏—Å–æ–≤–∫–æ–π –∫–æ–Ω—Ç—É—Ä–æ–≤ –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –æ—Ü–µ–Ω–∫–∏.
---

## üìú –ò—Å—Ç–æ—Ä–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ (Prompts)

–ù–∏–∂–µ –ø—Ä–∏–≤–µ–¥–µ–Ω—ã –∏—Å—Ö–æ–¥–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è.

### –ü—Ä–æ–º–ø—Ç 1 (–ë–∞–∑–æ–≤–∞—è –∑–∞–¥–∞—á–∞)
> –¢—ã –æ–ø—ã—Ç–Ω—ã–π python –ø—Ä–æ–≥—Ä–∞–º–∏—Å—Ç. –ó–∞–¥–∞—á–∞: –æ–±—É—á–∏—Ç—å –º–æ–¥–µ–ª—å —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É—è —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ ultralytics.
> –ë—É–¥—å –ª–∞–∫–æ–Ω–∏—á–µ–Ω –≤ –∫–æ–¥–µ, –Ω–æ –Ω–µ –∑–∞–±—ã–≤–∞–π –µ–≥–æ –∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å, –∏—Å–ø–æ–ª—å–∑—É–π –ª—É—á—à–∏–µ —Ç–µ—Ö–Ω–∏–∫–∏, –ø–æ–¥–æ–π–¥–∏ –∫ –¥–µ–ª—É –ø—Ä–æ—Ñ—Ñ–µ—Å–∏–æ–Ω–∞–ª—å–Ω–æ.
>
> –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: —Å–Ω–∏–º–∫–∏ —Å–ø—É—Ç–Ω–∏–∫–æ–≤–æ–π —Å—ä–µ–º–∫–∏ –±–æ–ª—å—à–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ geotif –∏ –≤–µ–∫—Ç–æ—Ä–Ω—ã–µ —Ñ–∞–π–ª—ã —Å –ø–ª–æ—â–∞–¥–Ω—ã–º–∏ –æ–±—ä–µ–∫—Ç–∞–º–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ shape. –û–¥–∏–Ω –≤–µ–∫—Ç–æ—Ä–Ω—ã–π —Ñ–∞–π–ª –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –æ–±—ä–µ–∫—Ç—ã –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–Ω–∏–º–∫–æ–≤. –¢–∞–∫–∂–µ —Å–Ω–∏–º–∫–∏ –º–æ–≥—É—Ç –ø–µ—Ä–µ–∫—Ä—ã–≤–∞—Ç—å—Å—è.
> –ù–∞ –ø–µ—Ä–≤–æ–º —ç—Ç–∞–ø–µ –Ω—É–∂–Ω–æ –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –¥–∞—Ç–∞—Å–µ—Ç –≤ —Ñ–æ—Ä–º–∞—Ç–µ ultralytics: —Ä–∞–∑–±–∏—Ç—å —Å–Ω–∏–º–∫–∏ –Ω–∞ —Ç–∞–π–ª—ã –∏ –Ω–∞–π—Ç–∏ –≤–æ –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –≤–µ–∫—Ç–æ—Ä–∞—Ö –æ–±—ä–µ–∫—Ç—ã –≤–Ω—É—Ç—Ä–∏ –∫–∞–∂–¥–æ–≥–æ —Ç–∞–π–ª–∞. –ò—Å–ø–æ–ª—å–∑—É–π –±–∏–±–ª–∏–æ—Ç–µ–∫—É rasterio.
> –ù–∞ –≤—Ç–æ—Ä–æ–º —ç—Ç–∞–ø–µ –æ–±—É—á–µ–Ω–∏–µ –Ω–∞ —Å–æ–∑–¥–∞–Ω–Ω–æ–º –¥–∞—Ç–∞—Å–µ—Ç–µ.
> –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π —Ç–µ—Ö –∑–∞–¥–∞–Ω–∏–µ. –î–æ–ø–æ–ª–Ω–∏ –∏–ª–∏ –ø–æ–∫—Ä–∏—Ç–∏–∫—É–π, –µ—Å–ª–∏ –±—É–¥—É—Ç –∑–∞–º–µ—á–∞–Ω–∏—è.
>
> –í—Å–µ–≥–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–∞–ø–∏—Å–∞–Ω–æ 2 —Å–∫—Ä–∏–ø—Ç–∞.

### –ü—Ä–æ–º–ø—Ç 2 (–ö—Ä–∏—Ç–∏–∫–∞ –∏ –¥–æ—Ä–∞–±–æ—Ç–∫–∞ —É—Ç–µ—á–∫–∏ –¥–∞–Ω–Ω—ã—Ö)
> –Ω–µ–ø–æ–Ω—è—Ç–Ω–æ –∫–∞–∫ —Ç—ã —Ä–µ—à–∏–ª –ø—Ä–æ–±–ª–µ–º—É —É—Ç–µ—á–∫–∏. –ï—Å–ª–∏ —Ä–∞–∑–±–∏–≤–∞—Ç—å –ø–æ —Å–Ω–∏–º–∫–∞–º, –∞ —Å–Ω–∏–º–∫–∏ –º–æ–≥—É—Ç –ø–µ—Ä–µ—Å–µ–∫–∞—Ç—å—Å—è, —Ç–æ –±—É–¥—É—Ç —Ç–∞–π–ª—ã —Å —Ä–∞–∑–Ω—ã—Ö —Å–Ω–∏–º–∫–æ–≤ –Ω–∞ –æ–¥–Ω—É —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏—é. –ò –æ–Ω–∏ –º–æ–≥—É—Ç –ø–æ–ø–∞—Å—Ç—å –≤ train/val –ø–∞–ø–∫–∏

*(–í –æ—Ç–≤–µ—Ç –Ω–∞ —ç—Ç–æ—Ç –ø—Ä–æ–º–ø—Ç –±—ã–ª —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –∞–ª–≥–æ—Ä–∏—Ç–º `Spatial Grid Split`, –∫–æ—Ç–æ—Ä—ã–π —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –≤ —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏ –∫–æ–¥–∞)*.

### –ü—Ä–æ–º–ø—Ç 3 (–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è)
> –Ω–∞–ø–∏—à–∏ readme.MD –£–∫–∞–∂–∏ —Ç–∞–º –∏—Å—Ö–æ–¥–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã, —Å–≤–æ–µ –∞–≤—Ç–æ—Ä—Å—Ç–≤–æ (–ò–ò –∞–≥–µ–Ω—Ç Gemini 3.0 Pro Preview), –ø–æ–¥—Ä–æ–±–Ω–æ –æ–ø–∏—à–∏ –≤—Å–µ –º–µ—Ç–æ–¥–∏–∫–∏, –ø–æ—Ä—è–¥–æ–∫ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–∞–ø—É—Å–∫–∞ –∏—Ç–ø

---

## ‚öñÔ∏è –õ–∏—Ü–µ–Ω–∑–∏—è
–≠—Ç–æ—Ç –∫–æ–¥ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω "–∫–∞–∫ –µ—Å—Ç—å" –≤ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –∏ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ü–µ–ª—è—Ö.***

# Satellite Segmentation Pipeline (YOLOv8 + Rasterio)

–≠—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–∞–π–ø–ª–∞–π–Ω –¥–ª—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ —Å–ø—É—Ç–Ω–∏–∫–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö (GeoTIFF + Shapefile) –∏ –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤ (Instance Segmentation) —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞ **Ultralytics (YOLOv8/v11)**.

–ü—Ä–æ–µ–∫—Ç —Ä–µ—à–∞–µ—Ç —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ –î–ó–ó (–¥–∞–Ω–Ω—ã—Ö –¥–∏—Å—Ç–∞–Ω—Ü–∏–æ–Ω–Ω–æ–≥–æ –∑–æ–Ω–¥–∏—Ä–æ–≤–∞–Ω–∏—è –ó–µ–º–ª–∏), —Ç–∞–∫–∏–µ –∫–∞–∫ –æ–≥—Ä–æ–º–Ω—ã–π —Ä–∞–∑–º–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –≥–µ–æ–ø—Ä–∏–≤—è–∑–∫–∞ –∏ –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ —Å–Ω–∏–º–∫–æ–≤.

> **–ê–≤—Ç–æ—Ä—Å—Ç–≤–æ:** –ö–æ–¥ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã –ò–ò –∞–≥–µ–Ω—Ç–æ–º **Gemini 3.0 Pro Preview**.

---

## üß† –ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è –∏ –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

–ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å–æ —Å–ø—É—Ç–Ω–∏–∫–æ–≤—ã–º–∏ —Å–Ω–∏–º–∫–∞–º–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –º–µ—Ç–æ–¥—ã –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–≥–æ –∑—Ä–µ–Ω–∏—è (CV) —á–∞—Å—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç. –í —ç—Ç–æ–º —Ä–µ—à–µ–Ω–∏–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –∫–ª—é—á–µ–≤—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏:

### 1. –ü—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ —Ä–∞–∑–±–∏–µ–Ω–∏–µ (Spatial Split) –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è —É—Ç–µ—á–∫–∏ –¥–∞–Ω–Ω—ã—Ö
**–ü—Ä–æ–±–ª–µ–º–∞:** –°–ø—É—Ç–Ω–∏–∫–æ–≤—ã–µ —Å–Ω–∏–º–∫–∏ —á–∞—Å—Ç–æ –ø–µ—Ä–µ–∫—Ä—ã–≤–∞—é—Ç—Å—è (overlap). –ï—Å–ª–∏ –ø—Ä–æ—Å—Ç–æ —Ä–∞–∑–±–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ –∏–ª–∏ —Ç–∞–π–ª–æ–≤ —Å–ª—É—á–∞–π–Ω–æ –Ω–∞ Train/Val, —Ç–∞–π–ª—ã –æ–¥–Ω–æ–π –∏ —Ç–æ–π –∂–µ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –¥–æ–º, —Å–Ω—è—Ç—ã–π –¥–≤–∞–∂–¥—ã) –ø–æ–ø–∞–¥—É—Ç –∏ –≤ –æ–±—É—á–µ–Ω–∏–µ, –∏ –≤ –≤–∞–ª–∏–¥–∞—Ü–∏—é. –≠—Ç–æ –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ Data Leakage –∏ –ª–æ–∂–Ω–æ –≤—ã—Å–æ–∫–∏–º –º–µ—Ç—Ä–∏–∫–∞–º.
**–†–µ—à–µ–Ω–∏–µ:**
*   –í—ã—á–∏—Å–ª—è—é—Ç—Å—è –æ–±—â–∏–µ –≥—Ä–∞–Ω–∏—Ü—ã (bounding box) –≤—Å–µ–π –æ–±–ª–∞—Å—Ç–∏ –∏–Ω—Ç–µ—Ä–µ—Å–∞.
*   –¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è —Ä–∞–∑–±–∏–≤–∞–µ—Ç—Å—è –Ω–∞ –∫—Ä—É–ø–Ω—É—é —Å–µ—Ç–∫—É (Grid, –Ω–∞–ø—Ä–∏–º–µ—Ä, 10x10 —è—á–µ–µ–∫).
*   –ö–∞–∂–¥–æ–π —è—á–µ–π–∫–µ –∂–µ—Å—Ç–∫–æ –Ω–∞–∑–Ω–∞—á–∞–µ—Ç—Å—è —Å—Ç–∞—Ç—É—Å `train` –∏–ª–∏ `val`.
*   –¢–∞–π–ª –ø–æ–ø–∞–¥–∞–µ—Ç –≤ –≤—ã–±–æ—Ä–∫—É –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–æ–≥–æ, –≤ –∫–∞–∫–æ–π –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –∫–≤–∞–¥—Ä–∞—Ç –ø–æ–ø–∞–¥–∞–µ—Ç –µ–≥–æ —Ü–µ–Ω—Ç—Ä.
*   **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –∏–∑–æ–ª—è—Ü–∏—è –≤—ã–±–æ—Ä–æ–∫.

### 2. –¢–∞–π–ª–∏–Ω–≥ —Å –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ–º (Sliding Window)
**–ü—Ä–æ–±–ª–µ–º–∞:** –û–±—ä–µ–∫—Ç—ã –Ω–∞ –≥—Ä–∞–Ω–∏—Ü–µ —Ä–∞–∑—Ä–µ–∑–∞ —Ç–∞–π–ª–æ–≤ (640x640) —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–º–∏ –∏–ª–∏ –æ–±—Ä–µ–∑–∞—é—Ç—Å—è, —á—Ç–æ —É—Ö—É–¥—à–∞–µ—Ç –æ–±—É—á–µ–Ω–∏–µ.
**–†–µ—à–µ–Ω–∏–µ:** –°–Ω–∏–º–∫–∏ –Ω–∞—Ä–µ–∑–∞—é—Ç—Å—è —Å –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ–º (overlap, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 20%). –≠—Ç–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—É—á–∞—é—â–∏—Ö –ø—Ä–∏–º–µ—Ä–æ–≤ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –æ–±—ä–µ–∫—Ç–æ–≤.

### 3. –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –∫–ª–∞—Å—Å–æ–≤ (Filtering)
**–ü—Ä–æ–±–ª–µ–º–∞:** –°–ø—É—Ç–Ω–∏–∫–æ–≤—ã–µ —Å–Ω–∏–º–∫–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç –æ–≥—Ä–æ–º–Ω—ã–µ –ø—É—Å—Ç—ã–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ (–ª–µ—Å–∞, –ø–æ–ª—è), –≥–¥–µ –Ω–µ—Ç —Ü–µ–ª–µ–≤—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤. –û–±—É—á–µ–Ω–∏–µ –Ω–∞ 90% –ø—É—Å—Ç—ã—Ö –∫–∞—Ä—Ç–∏–Ω–æ–∫ –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ.
**–†–µ—à–µ–Ω–∏–µ:** –°–∫—Ä–∏–ø—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ç–∞–π–ª, —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –≤ –Ω–µ–º –µ—Å—Ç—å –æ–±—ä–µ–∫—Ç—ã. –ü—É—Å—Ç—ã–µ —Ç–∞–π–ª—ã ("—Ñ–æ–Ω") –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è —Å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é 10% (–ø–∞—Ä–∞–º–µ—Ç—Ä `bg_ratio`), —á—Ç–æ–±—ã –º–æ–¥–µ–ª—å —É—á–∏–ª–∞—Å—å —Ä–∞–∑–ª–∏—á–∞—Ç—å background.

### 4. –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –≥–µ–æ-—Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è
–ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ `rasterio` –∏ `shapely` –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ –ø–µ—Ä–µ–≤–æ–¥–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –∏–∑ –ø—Ä–æ–µ–∫—Ü–∏–∏ –∫–∞—Ä—Ç—ã (CRS, –Ω–∞–ø—Ä–∏–º–µ—Ä, UTM) –≤ –ø–∏–∫—Å–µ–ª—å–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ç–∞–π–ª–∞ –∏ –ø–æ—Å–ª–µ–¥—É—é—â–µ–π –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ (0-1) –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∞ YOLO.

---

## üõ† –£—Å—Ç–∞–Ω–æ–≤–∫–∞

–î–ª—è —Ä–∞–±–æ—Ç—ã —Ç—Ä–µ–±—É—é—Ç—Å—è Python 3.8+ –∏ —Å–ª–µ–¥—É—é—â–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:

```bash
pip install ultralytics rasterio geopandas shapely opencv-python tqdm pyyaml
```

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

–ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –æ—Ä–≥–∞–Ω–∏–∑—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

```text
project_root/
‚îú‚îÄ‚îÄ raw_data/
‚îÇ   ‚îú‚îÄ‚îÄ images/         # –ü–∞–ø–∫–∞ —Å –∏—Å—Ö–æ–¥–Ω—ã–º–∏ GeoTIFF —Å–Ω–∏–º–∫–∞–º–∏ (*.tif)
‚îÇ   ‚îî‚îÄ‚îÄ labels.shp      # –í–µ–∫—Ç–æ—Ä–Ω—ã–π —Ñ–∞–π–ª —Å —Ä–∞–∑–º–µ—Ç–∫–æ–π (Shapefile)
‚îú‚îÄ‚îÄ datasets/           # –°—é–¥–∞ –±—É–¥–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –¥–∞—Ç–∞—Å–µ—Ç (—Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
‚îú‚îÄ‚îÄ prepare_data_spatial.py
‚îú‚îÄ‚îÄ train_segmentation.py
‚îî‚îÄ‚îÄ README.md
```

*–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –í–µ–∫—Ç–æ—Ä–Ω—ã–π —Ñ–∞–π–ª –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–¥–∏–Ω –Ω–∞ –≤—Å–µ —Å–Ω–∏–º–∫–∏ –∏–ª–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –æ–±—ä–µ–∫—Ç—ã –¥–ª—è —á–∞—Å—Ç–∏ —Å–Ω–∏–º–∫–æ–≤. –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞–π–¥–µ—Ç –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è.*

---

## üöÄ –ó–∞–ø—É—Å–∫

### –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞

–û—Ç–∫—Ä–æ–π—Ç–µ `prepare_data_spatial.py` –∏ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Å–µ–∫—Ü–∏—é `CONFIG` (–ø—É—Ç–∏, —Ä–∞–∑–º–µ—Ä —Ç–∞–π–ª–∞, –ø—Ä–æ—Ü–µ–Ω—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏).

–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç:
```bash
python prepare_data_spatial.py
```
**–ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç:**
1. –°–∫—Ä–∏–ø—Ç –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –≥—Ä–∞–Ω–∏—Ü—ã –≤—Å–µ—Ö —Å–Ω–∏–º–∫–æ–≤ –∏ —Å–æ–∑–¥–∞—Å—Ç —Å–µ—Ç–∫—É —Ä–∞–∑–±–∏–µ–Ω–∏—è.
2. –ù–∞—Ä–µ–∂–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ —Ç–∞–π–ª—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, 640x640).
3. –ù–∞–π–¥–µ—Ç –≤–µ–∫—Ç–æ—Ä–∞ –≤–Ω—É—Ç—Ä–∏ –∫–∞–∂–¥–æ–≥–æ —Ç–∞–π–ª–∞ –∏ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –∏—Ö –≤ —Ñ–æ—Ä–º–∞—Ç YOLO TXT.
4. –û—Ç—Ñ–∏–ª—å—Ç—Ä—É–µ—Ç –ø—É—Å—Ç—ã–µ —Ç–∞–π–ª—ã.
5. –°–æ–∑–¥–∞—Å—Ç —Ñ–∞–π–ª `data.yaml`.

### –®–∞–≥ 2: –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏

–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –æ–±—É—á–µ–Ω–∏—è:
```bash
python train_segmentation.py
```
**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–±—É—á–µ–Ω–∏—è:**
*   –ú–æ–¥–µ–ª—å: `yolov8m-seg.pt` (Medium) ‚Äî –±–∞–ª–∞–Ω—Å —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏ —Ç–æ—á–Ω–æ—Å—Ç–∏.
*   –ê—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏: –í–∫–ª—é—á–µ–Ω—ã –ø–æ–≤–æ—Ä–æ—Ç—ã –Ω–∞ 90 –≥—Ä–∞–¥—É—Å–æ–≤ (FlipUD, FlipLR, Degrees), —Ç–∞–∫ –∫–∞–∫ —Å–ø—É—Ç–Ω–∏–∫–æ–≤—ã–µ —Å–Ω–∏–º–∫–∏ –Ω–µ –∏–º–µ—é—Ç "–≤–µ—Ä—Ö–∞" –∏ "–Ω–∏–∑–∞".
*   Epochs: 100.

---

## üìú –ò—Å—Ç–æ—Ä–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ (Prompts)

–ù–∏–∂–µ –ø—Ä–∏–≤–µ–¥–µ–Ω—ã –∏—Å—Ö–æ–¥–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è.

### –ü—Ä–æ–º–ø—Ç 1 (–ë–∞–∑–æ–≤–∞—è –∑–∞–¥–∞—á–∞)
> –¢—ã –æ–ø—ã—Ç–Ω—ã–π python –ø—Ä–æ–≥—Ä–∞–º–∏—Å—Ç. –ó–∞–¥–∞—á–∞: –æ–±—É—á–∏—Ç—å –º–æ–¥–µ–ª—å —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É—è —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ ultralytics.
> –ë—É–¥—å –ª–∞–∫–æ–Ω–∏—á–µ–Ω –≤ –∫–æ–¥–µ, –Ω–æ –Ω–µ –∑–∞–±—ã–≤–∞–π –µ–≥–æ –∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å, –∏—Å–ø–æ–ª—å–∑—É–π –ª—É—á—à–∏–µ —Ç–µ—Ö–Ω–∏–∫–∏, –ø–æ–¥–æ–π–¥–∏ –∫ –¥–µ–ª—É –ø—Ä–æ—Ñ—Ñ–µ—Å–∏–æ–Ω–∞–ª—å–Ω–æ.
>
> –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: —Å–Ω–∏–º–∫–∏ —Å–ø—É—Ç–Ω–∏–∫–æ–≤–æ–π —Å—ä–µ–º–∫–∏ –±–æ–ª—å—à–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ geotif –∏ –≤–µ–∫—Ç–æ—Ä–Ω—ã–µ —Ñ–∞–π–ª—ã —Å –ø–ª–æ—â–∞–¥–Ω—ã–º–∏ –æ–±—ä–µ–∫—Ç–∞–º–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ shape. –û–¥–∏–Ω –≤–µ–∫—Ç–æ—Ä–Ω—ã–π —Ñ–∞–π–ª –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –æ–±—ä–µ–∫—Ç—ã –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–Ω–∏–º–∫–æ–≤. –¢–∞–∫–∂–µ —Å–Ω–∏–º–∫–∏ –º–æ–≥—É—Ç –ø–µ—Ä–µ–∫—Ä—ã–≤–∞—Ç—å—Å—è.
> –ù–∞ –ø–µ—Ä–≤–æ–º —ç—Ç–∞–ø–µ –Ω—É–∂–Ω–æ –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –¥–∞—Ç–∞—Å–µ—Ç –≤ —Ñ–æ—Ä–º–∞—Ç–µ ultralytics: —Ä–∞–∑–±–∏—Ç—å —Å–Ω–∏–º–∫–∏ –Ω–∞ —Ç–∞–π–ª—ã –∏ –Ω–∞–π—Ç–∏ –≤–æ –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –≤–µ–∫—Ç–æ—Ä–∞—Ö –æ–±—ä–µ–∫—Ç—ã –≤–Ω—É—Ç—Ä–∏ –∫–∞–∂–¥–æ–≥–æ —Ç–∞–π–ª–∞. –ò—Å–ø–æ–ª—å–∑—É–π –±–∏–±–ª–∏–æ—Ç–µ–∫—É rasterio.
> –ù–∞ –≤—Ç–æ—Ä–æ–º —ç—Ç–∞–ø–µ –æ–±—É—á–µ–Ω–∏–µ –Ω–∞ —Å–æ–∑–¥–∞–Ω–Ω–æ–º –¥–∞—Ç–∞—Å–µ—Ç–µ.
> –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π —Ç–µ—Ö –∑–∞–¥–∞–Ω–∏–µ. –î–æ–ø–æ–ª–Ω–∏ –∏–ª–∏ –ø–æ–∫—Ä–∏—Ç–∏–∫—É–π, –µ—Å–ª–∏ –±—É–¥—É—Ç –∑–∞–º–µ—á–∞–Ω–∏—è.
>
> –í—Å–µ–≥–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–∞–ø–∏—Å–∞–Ω–æ 2 —Å–∫—Ä–∏–ø—Ç–∞.

### –ü—Ä–æ–º–ø—Ç 2 (–ö—Ä–∏—Ç–∏–∫–∞ –∏ –¥–æ—Ä–∞–±–æ—Ç–∫–∞ —É—Ç–µ—á–∫–∏ –¥–∞–Ω–Ω—ã—Ö)
> –Ω–µ–ø–æ–Ω—è—Ç–Ω–æ –∫–∞–∫ —Ç—ã —Ä–µ—à–∏–ª –ø—Ä–æ–±–ª–µ–º—É —É—Ç–µ—á–∫–∏. –ï—Å–ª–∏ —Ä–∞–∑–±–∏–≤–∞—Ç—å –ø–æ —Å–Ω–∏–º–∫–∞–º, –∞ —Å–Ω–∏–º–∫–∏ –º–æ–≥—É—Ç –ø–µ—Ä–µ—Å–µ–∫–∞—Ç—å—Å—è, —Ç–æ –±—É–¥—É—Ç —Ç–∞–π–ª—ã —Å —Ä–∞–∑–Ω—ã—Ö —Å–Ω–∏–º–∫–æ–≤ –Ω–∞ –æ–¥–Ω—É —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏—é. –ò –æ–Ω–∏ –º–æ–≥—É—Ç –ø–æ–ø–∞—Å—Ç—å –≤ train/val –ø–∞–ø–∫–∏

*(–í –æ—Ç–≤–µ—Ç –Ω–∞ —ç—Ç–æ—Ç –ø—Ä–æ–º–ø—Ç –±—ã–ª —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –∞–ª–≥–æ—Ä–∏—Ç–º `Spatial Grid Split`, –∫–æ—Ç–æ—Ä—ã–π —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –≤ —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏ –∫–æ–¥–∞)*.

### –ü—Ä–æ–º–ø—Ç 3 (–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è)
> –Ω–∞–ø–∏—à–∏ readme.MD –£–∫–∞–∂–∏ —Ç–∞–º –∏—Å—Ö–æ–¥–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã, —Å–≤–æ–µ –∞–≤—Ç–æ—Ä—Å—Ç–≤–æ (–ò–ò –∞–≥–µ–Ω—Ç Gemini 3.0 Pro Preview), –ø–æ–¥—Ä–æ–±–Ω–æ –æ–ø–∏—à–∏ –≤—Å–µ –º–µ—Ç–æ–¥–∏–∫–∏, –ø–æ—Ä—è–¥–æ–∫ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–∞–ø—É—Å–∫–∞ –∏—Ç–ø

---

## ‚öñÔ∏è –õ–∏—Ü–µ–Ω–∑–∏—è
–≠—Ç–æ—Ç –∫–æ–¥ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω "–∫–∞–∫ –µ—Å—Ç—å" –≤ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –∏ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ü–µ–ª—è—Ö.